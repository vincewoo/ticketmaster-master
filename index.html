<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ticketmaster Master - Beat the Rush!</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://unpkg.com/peerjs@1.5.1/dist/peerjs.min.js"></script>
</head>
<body>
    <div id="game-container">
        <!-- Header with game info -->
        <header class="game-header">
            <div class="header-left">
                <h1>üé´ Ticketmaster Master</h1>
                <p class="event-name">Summer Music Festival 2025</p>
            </div>
            <div class="header-right">
                <div class="target-display">
                    <span class="label">Target Tickets:</span>
                    <span id="target-tickets" class="target-tickets">0</span>
                </div>
                <div class="timer-display">
                    <span class="label">Time Remaining:</span>
                    <span id="timer" class="timer">2:00</span>
                </div>
                <div class="score-display">
                    <span class="label">Your Score:</span>
                    <span id="score" class="score">0</span>
                </div>
                <div class="opponent-score-display hidden" id="opponent-score-display">
                    <span class="label">Opponent:</span>
                    <span id="opponent-score" class="score">0</span>
                </div>
            </div>
        </header>

        <!-- Main game area -->
        <div class="game-main">
            <!-- Theater area (stage + seats) -->
            <div class="theater-area">
                <!-- Stage area -->
                <div class="stage-container">
                    <div class="stage">üé§ STAGE üé§</div>
                </div>

                <!-- Seating chart -->
                <div class="seating-chart" id="seating-chart">
                    <!-- Seats will be generated by JavaScript -->
                </div>
            </div>

            <!-- Sidebar with cart -->
            <aside class="sidebar">
                <div class="cart-container">
                    <h2>Your Cart</h2>
                    <div id="cart-items" class="cart-items">
                        <p class="empty-cart">No tickets selected</p>
                    </div>
                    <div class="cart-total">
                        <strong>Total:</strong>
                        <span id="cart-total">$0.00</span>
                    </div>
                    <button id="checkout-btn" class="checkout-btn" disabled>Checkout</button>
                    <button id="skip-btn" class="skip-btn">Skip Target (-50 pts)</button>
                </div>

                <div class="game-info">
                    <h3>How to Play</h3>
                    <ul>
                        <li>Match the target ticket count shown at top</li>
                        <li>1-3 seats: must be adjacent in same row</li>
                        <li>4+ seats: can span 2 rows as touching block
                            <div class="block-examples">
                                <div class="example-label">Valid blocks:</div>
                                <div class="block-diagram">
                                    <div class="block-row">Row A: [‚ñ†][‚ñ†]</div>
                                    <div class="block-row">Row B: [‚ñ†][‚ñ†]</div>
                                </div>
                                <div class="block-diagram">
                                    <div class="block-row">Row A: [‚ñ†][‚ñ†][‚ñ†]</div>
                                    <div class="block-row">Row B: [‚ñ†][‚ñ†]</div>
                                </div>
                                <div class="block-diagram">
                                    <div class="block-row">Row A: [‚ñ†][‚ñ†]</div>
                                    <div class="block-row">Row B: [ ][‚ñ†][‚ñ†]</div>
                                </div>
                            </div>
                        </li>
                        <li>Can't find seats? Skip target for -50 pts penalty</li>
                        <li>Prices change constantly - grab deals fast!</li>
                        <li>Seats randomly become available/unavailable</li>
                        <li>Complete CAPTCHA challenges to checkout</li>
                        <li>Only valid purchases earn points!</li>
                    </ul>
                </div>
            </aside>
        </div>

        <!-- CAPTCHA Modal -->
        <div id="captcha-modal" class="modal hidden">
            <div class="modal-content">
                <h2>Security Verification</h2>
                <p>Prove you're human to continue!</p>
                <div id="captcha-warning" class="captcha-warning hidden">
                    ‚ö†Ô∏è Warning: Another player is competing for these seats!
                </div>
                <div class="captcha-timer">
                    Time: <span id="captcha-timer">10</span>s
                </div>
                <div class="captcha-challenge" id="captcha-challenge">
                    <!-- CAPTCHA will be generated here -->
                </div>
                <input type="text" id="captcha-input" class="captcha-input" placeholder="Enter the code">
                <div class="captcha-buttons">
                    <button id="captcha-submit" class="btn-primary">Submit</button>
                    <button id="captcha-cancel" class="btn-secondary">Cancel</button>
                </div>
                <div id="captcha-error" class="captcha-error hidden"></div>
            </div>
        </div>

        <!-- Game Over Modal -->
        <div id="gameover-modal" class="modal hidden">
            <div class="modal-content gameover-content">
                <h2>Game Over!</h2>
                <div class="final-stats">
                    <p class="final-score">Final Score: <span id="final-score">0</span></p>
                    <p class="tickets-bought">Tickets Purchased: <span id="tickets-bought">0</span></p>
                    <p class="total-saved">Total Saved: <span id="total-saved">$0</span></p>
                    <p class="skips-count">Targets Skipped: <span id="skips-count">0</span></p>
                    <p class="skip-penalty">Skip Penalty: <span id="skip-penalty-total">0 pts</span></p>
                </div>
                <div class="purchase-history-section" id="purchase-history-section">
                    <h3>Purchase History</h3>
                    <div class="purchase-history" id="purchase-history">
                        <!-- Purchase history will be generated here -->
                    </div>
                </div>
                <button id="play-again-btn" class="btn-primary">Play Again</button>
            </div>
        </div>

        <!-- Start Screen -->
        <div id="start-modal" class="modal">
            <div class="modal-content start-modal-content">
                <h2>üé´ Welcome to Ticketmaster Master!</h2>
                <p>Beat the rush and score the best deals on concert tickets!</p>
                <div class="start-info">
                    <p><strong>Game Duration:</strong> 2 minutes</p>
                    <p><strong>Objective:</strong> Purchase tickets and maximize your savings</p>
                    <p><strong>Challenge:</strong> Prices fluctuate and seats disappear fast!</p>
                </div>
                <div class="start-instructions">
                    <h3>How to Play</h3>
                    <ul>
                        <li>Match the target ticket count shown at top</li>
                        <li>1-3 seats: must be adjacent in same row</li>
                        <li>4+ seats: can span 2 rows as touching block
                            <div class="block-examples">
                                <div class="example-label">Valid blocks:</div>
                                <div class="block-diagram">
                                    <div class="block-row">Row A: [‚ñ†][‚ñ†]</div>
                                    <div class="block-row">Row B: [‚ñ†][‚ñ†]</div>
                                </div>
                                <div class="block-diagram">
                                    <div class="block-row">Row A: [‚ñ†][‚ñ†][‚ñ†]</div>
                                    <div class="block-row">Row B: [‚ñ†][‚ñ†]</div>
                                </div>
                                <div class="block-diagram">
                                    <div class="block-row">Row A: [‚ñ†][‚ñ†]</div>
                                    <div class="block-row">Row B: [ ][‚ñ†][‚ñ†]</div>
                                </div>
                            </div>
                        </li>
                        <li>Can't find seats? Skip target for -50 pts penalty</li>
                        <li>Prices change constantly - grab deals fast!</li>
                        <li>Seats randomly become available/unavailable</li>
                        <li>Complete CAPTCHA challenges to checkout</li>
                        <li>Only valid purchases earn points!</li>
                    </ul>
                </div>
                <div class="mode-selection">
                    <button id="single-player-btn" class="btn-primary btn-large">Single Player</button>
                    <button id="multiplayer-btn" class="btn-secondary btn-large">Multiplayer</button>
                </div>
            </div>
        </div>

        <!-- Multiplayer Setup Modal -->
        <div id="multiplayer-modal" class="modal hidden">
            <div class="modal-content">
                <h2>Multiplayer Mode</h2>
                <p>Compete with a friend for the best deals!</p>
                <div class="multiplayer-options">
                    <button id="host-game-btn" class="btn-primary btn-large">Host Game</button>
                    <button id="join-game-btn" class="btn-secondary btn-large">Join Game</button>
                </div>
                <button id="back-to-start-btn" class="btn-secondary">Back</button>
            </div>
        </div>

        <!-- Host Game Modal -->
        <div id="host-modal" class="modal hidden">
            <div class="modal-content">
                <h2>Host Game</h2>
                <p>Share this code with your friend:</p>
                <div class="game-code-display">
                    <input type="text" id="game-code" class="game-code-input" readonly>
                    <button id="copy-code-btn" class="btn-secondary">Copy</button>
                </div>
                <p class="connection-status" id="host-status">Waiting for player to join...</p>
                <button id="cancel-host-btn" class="btn-secondary">Cancel</button>
            </div>
        </div>

        <!-- Join Game Modal -->
        <div id="join-modal" class="modal hidden">
            <div class="modal-content">
                <h2>Join Game</h2>
                <p>Enter the game code from your friend:</p>
                <input type="text" id="join-code-input" class="game-code-input" placeholder="Enter code">
                <p class="connection-status" id="join-status"></p>
                <div class="modal-buttons">
                    <button id="connect-btn" class="btn-primary">Connect</button>
                    <button id="cancel-join-btn" class="btn-secondary">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Loading Screen Modal -->
        <div id="loading-modal" class="modal hidden">
            <div class="modal-content loading-content">
                <h2>Ticketmaster Waiting Room</h2>
                <p class="loading-status" id="loading-status">Getting you ready...</p>
                <div class="fan-count" id="fan-count">47,823 fans in front of you</div>
                <div class="ready-message hidden" id="ready-message">It's your turn! Get ready to buy your tickets!</div>
                <div class="progress-container">
                    <div class="progress-bar" id="progress-bar"></div>
                    <div class="stick-figure" id="stick-figure">üö∂‚Äç‚û°Ô∏è</div>
                </div>
            </div>
        </div>
    </div>

    <script src="game.js?v=21"></script>
</body>
</html>
